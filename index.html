<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AURA / ARCHIVE - Premium Urban Wear</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Three.js Core -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.159.0/build/three.min.js"></script>
    
    <!-- Three.js Addons -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.159.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.159.0/examples/js/loaders/GLTFLoader.js"></script>
    
    <!-- Icons -->
    <script src="https://code.iconify.design/3/3.1.0/iconify.min.js"></script>
    
    <!-- Stripe.js -->
    <script src="https://js.stripe.com/v3/"></script>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500&family=Space+Grotesk:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --cursor-size: 20px;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #050505;
            color: #e5e5e5;
            overflow-x: hidden;
        }
        h1, h2, h3, h4, .brand-font {
            font-family: 'Space Grotesk', sans-serif;
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #0a0a0a;
        }
        ::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 3px;
        }

        /* 3D Scene Utilities */
        .scene {
            perspective: 1000px;
        }
        .preserve-3d {
            transform-style: preserve-3d;
        }
        
        /* Floating Animation */
        @keyframes float {
            0% { transform: translateY(0px) rotate3d(1, 1, 1, 2deg); }
            50% { transform: translateY(-20px) rotate3d(1, 1, 1, -2deg); }
            100% { transform: translateY(0px) rotate3d(1, 1, 1, 2deg); }
        }
        .animate-float {
            animation: float 6s ease-in-out infinite;
        }

        /* Mesh Gradient Background */
        .mesh-bg {
            background-image: 
                radial-gradient(at 0% 0%, hsla(253,16%,7%,1) 0, transparent 50%), 
                radial-gradient(at 50% 0%, hsla(225,39%,30%,1) 0, transparent 50%), 
                radial-gradient(at 100% 0%, hsla(339,49%,30%,1) 0, transparent 50%);
            filter: blur(100px);
            opacity: 0.4;
            position: absolute;
            inset: 0;
            z-index: -1;
        }

        /* Glitch Text Effect */
        .glitch-wrapper {
            position: relative;
        }
        
        /* Marquee Animation */
        @keyframes marquee {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }
        
        /* Custom Range Input */
        input[type="range"] {
            -webkit-appearance: none;
            background: transparent;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 16px;
            width: 16px;
            border-radius: 50%;
            background: #fff;
            margin-top: -6px;
            cursor: pointer;
            border: 2px solid #000;
        }
        input[type="range"]::-webkit-slider-runnable-track {
            width: 100%;
            height: 4px;
            cursor: pointer;
            background: #333;
            border-radius: 2px;
        }
        
        /* Loading Spinner */
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .spinner {
            border: 3px solid rgba(255,255,255,0.1);
            border-top-color: #fff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.9);
            z-index: 9999;
            backdrop-filter: blur(10px);
        }
        .modal.active {
            display: flex;
        }
        
        /* Canvas Container */
        #mockup-container canvas {
            display: block;
            width: 100% !important;
            height: 100% !important;
        }
    </style>
</head>
<body class="antialiased selection:bg-white selection:text-black">

    <!-- Background Elements -->
    <div class="fixed top-0 left-0 w-full h-full pointer-events-none overflow-hidden">
        <div class="mesh-bg"></div>
        <div class="absolute bottom-0 right-0 w-96 h-96 bg-purple-900/20 rounded-full blur-[128px]"></div>
    </div>

    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 border-b border-white/5 backdrop-blur-md bg-black/50">
        <div class="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <span class="iconify text-white" data-icon="lucide:box-select" data-width="24"></span>
                <span class="brand-font text-lg tracking-widest font-medium">AURA / ARCHIVE</span>
            </div>
            
            <div class="hidden md:flex items-center gap-8 text-xs tracking-widest uppercase text-neutral-400">
                <a href="#collection" class="hover:text-white transition-colors">Collection</a>
                <a href="#fabricate" class="text-white relative">
                    Fabricate
                    <span class="absolute -top-1 -right-2 h-1.5 w-1.5 bg-green-500 rounded-full animate-pulse"></span>
                </a>
                <button onclick="toggleAdminPanel()" class="hover:text-white transition-colors">Admin</button>
            </div>

            <div class="flex items-center gap-4">
                <button class="p-2 hover:bg-white/10 rounded-full transition-colors">
                    <span class="iconify text-neutral-300" data-icon="lucide:search" data-width="20"></span>
                </button>
                <button onclick="toggleCart()" class="p-2 hover:bg-white/10 rounded-full transition-colors relative">
                    <span class="iconify text-neutral-300" data-icon="lucide:shopping-bag" data-width="20"></span>
                    <span id="cart-count" class="absolute top-1 right-1 h-4 w-4 bg-white text-black rounded-full text-[10px] flex items-center justify-center font-bold">0</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="relative min-h-screen flex flex-col justify-center items-center overflow-hidden pt-20">
        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] border border-white/5 rounded-full animate-[spin_60s_linear_infinite] opacity-20 pointer-events-none"></div>
        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] border border-white/5 rounded-full animate-[spin_40s_linear_infinite_reverse] opacity-20 pointer-events-none"></div>

        <div class="z-10 text-center space-y-8 scene">
            <div class="preserve-3d animate-float">
                <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full border border-white/10 bg-white/5 backdrop-blur-sm text-xs text-neutral-300 tracking-wide mb-6">
                    <span class="h-1.5 w-1.5 bg-green-400 rounded-full"></span>
                    V2.0 SYSTEM ONLINE
                </div>
                <h1 class="text-6xl md:text-8xl lg:text-9xl tracking-tight text-transparent bg-clip-text bg-gradient-to-b from-white to-white/40 glitch-wrapper" data-text="BEYOND FABRIC">
                    BEYOND FABRIC
                </h1>
                <p class="mt-6 text-neutral-400 text-sm md:text-base max-w-lg mx-auto tracking-wide leading-relaxed">
                    Digital tailoring for the physical realm. High-fidelity streetwear designed with algorithmic precision.
                </p>
            </div>

            <div class="flex justify-center gap-4 mt-8">
                <a href="#fabricate" class="group relative px-8 py-3 bg-white text-black text-xs font-medium uppercase tracking-widest overflow-hidden">
                    <div class="absolute inset-0 w-full h-full bg-neutral-300 translate-y-full transition-transform duration-300 group-hover:translate-y-0"></div>
                    <span class="relative group-hover:text-black">Start Design</span>
                </a>
                <button class="px-8 py-3 border border-white/20 text-white text-xs font-medium uppercase tracking-widest hover:bg-white/5 transition-colors">
                    Explore Drops
                </button>
            </div>
        </div>
        
        <div class="absolute bottom-10 right-10 hidden lg:block opacity-50">
            <span class="text-[10px] uppercase tracking-widest text-neutral-600 block mb-2 text-right">Render Engine: Active</span>
            <div class="flex gap-1 justify-end">
                <div class="w-1 h-4 bg-green-500"></div>
                <div class="w-1 h-6 bg-green-500/50"></div>
                <div class="w-1 h-3 bg-green-500/30"></div>
            </div>
        </div>
    </section>

    <!-- Infinite Marquee -->
    <div class="w-full bg-white text-black overflow-hidden py-3 border-y border-white">
        <div class="flex whitespace-nowrap animate-[marquee_20s_linear_infinite]">
            <span class="mx-8 text-xl font-medium tracking-tight uppercase">Limited Edition</span>
            <span class="iconify mx-2" data-icon="lucide:star" data-width="20"></span>
            <span class="mx-8 text-xl font-medium tracking-tight uppercase">Global Shipping</span>
            <span class="iconify mx-2" data-icon="lucide:globe" data-width="20"></span>
            <span class="mx-8 text-xl font-medium tracking-tight uppercase">Next Gen Materials</span>
            <span class="iconify mx-2" data-icon="lucide:cpu" data-width="20"></span>
            <span class="mx-8 text-xl font-medium tracking-tight uppercase">Limited Edition</span>
            <span class="iconify mx-2" data-icon="lucide:star" data-width="20"></span>
            <span class="mx-8 text-xl font-medium tracking-tight uppercase">Global Shipping</span>
            <span class="iconify mx-2" data-icon="lucide:globe" data-width="20"></span>
            <span class="mx-8 text-xl font-medium tracking-tight uppercase">Next Gen Materials</span>
            <span class="iconify mx-2" data-icon="lucide:cpu" data-width="20"></span>
        </div>
    </div>

    <!-- Collection Grid -->
    <section id="collection" class="py-24 px-6 max-w-7xl mx-auto">
        <div class="flex justify-between items-end mb-16">
            <div>
                <h2 class="text-3xl md:text-5xl tracking-tight mb-2">ARCHIVE_001</h2>
                <p class="text-neutral-500 text-sm">Season 1 / Digital Native</p>
            </div>
            <div class="hidden md:flex gap-2">
                <button class="p-2 border border-white/10 hover:bg-white/5"><span class="iconify" data-icon="lucide:layout-grid" data-width="18"></span></button>
                <button class="p-2 border border-white/10 hover:bg-white/5"><span class="iconify" data-icon="lucide:list" data-width="18"></span></button>
            </div>
        </div>

        <div id="products-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-12">
            <!-- Products injected by JavaScript -->
        </div>
    </section>

    <!-- "Fabricate" Customizer Section -->
    <section id="fabricate" class="relative py-24 bg-neutral-900 border-y border-white/5 overflow-hidden">
        <div class="absolute inset-0 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-neutral-800 via-neutral-900 to-black opacity-50"></div>
        
        <div class="max-w-7xl mx-auto px-6 relative z-10 h-full flex flex-col lg:flex-row gap-12 items-start">
            
            <!-- Controls (Left) -->
            <div class="w-full lg:w-1/3 space-y-8">
                <div>
                    <div class="flex items-center gap-2 mb-2 text-green-400">
                        <span class="iconify" data-icon="lucide:box" data-width="16"></span>
                        <span class="text-[10px] uppercase tracking-widest font-bold">Design Lab</span>
                    </div>
                    <h2 class="text-4xl md:text-5xl tracking-tight mb-4">FABRICATE<br>YOUR REALITY</h2>
                    <p class="text-neutral-400 text-sm leading-relaxed">
                        Use our proprietary 3D simulation tools to customize your garment. Select colorways, apply rare decals, and adjust sizing specifications.
                    </p>
                </div>

                <!-- Custom UI Controls -->
                <div class="space-y-6 border-t border-white/10 pt-6">
                    
                    <!-- Color Picker -->
                    <div>
                        <label class="text-xs uppercase tracking-widest text-neutral-500 mb-3 block">Base Pigment</label>
                        <div class="flex gap-3">
                            <button onclick="changeColor('#111827')" class="w-10 h-10 rounded-full bg-gray-900 border-2 border-transparent hover:border-white/50 transition-all ring-2 ring-transparent focus:ring-white" data-color></button>
                            <button onclick="changeColor('#7f1d1d')" class="w-10 h-10 rounded-full bg-red-900 border-2 border-transparent hover:border-white/50 transition-all ring-2 ring-transparent focus:ring-white" data-color></button>
                            <button onclick="changeColor('#312e81')" class="w-10 h-10 rounded-full bg-indigo-900 border-2 border-transparent hover:border-white/50 transition-all ring-2 ring-transparent focus:ring-white" data-color></button>
                            <button onclick="changeColor('#064e3b')" class="w-10 h-10 rounded-full bg-emerald-900 border-2 border-transparent hover:border-white/50 transition-all ring-2 ring-transparent focus:ring-white" data-color></button>
                        </div>
                    </div>

                    <!-- Material Selector -->
                    <div>
                        <label class="text-xs uppercase tracking-widest text-neutral-500 mb-3 block">Material Finish</label>
                        <div class="grid grid-cols-2 gap-2">
                            <button onclick="setMaterial('standard')" class="px-4 py-2 border border-white/10 text-xs hover:bg-white/5 rounded transition-colors" data-material>Standard</button>
                            <button onclick="setMaterial('glossy')" class="px-4 py-2 border border-white/10 text-xs hover:bg-white/5 rounded transition-colors" data-material>Glossy</button>
                            <button onclick="setMaterial('matte')" class="px-4 py-2 border border-white/10 text-xs hover:bg-white/5 rounded transition-colors" data-material>Matte</button>
                            <button onclick="setMaterial('metallic')" class="px-4 py-2 border border-white/10 text-xs hover:bg-white/5 rounded transition-colors" data-material>Metallic</button>
                        </div>
                    </div>

                    <!-- Decal Toggle -->
                    <div>
                        <label class="text-xs uppercase tracking-widest text-neutral-500 mb-3 block">Graphic Module</label>
                        <div class="grid grid-cols-2 gap-2">
                            <button onclick="setDecal('none')" class="px-4 py-2 border border-white/10 text-xs hover:bg-white/5 rounded transition-colors" data-decal>None</button>
                            <button onclick="setDecal('logo')" class="px-4 py-2 border border-white/10 text-xs hover:bg-white/5 rounded transition-colors" data-decal>Aura Logo</button>
                            <button onclick="setDecal('warning')" class="px-4 py-2 border border-white/10 text-xs hover:bg-white/5 rounded transition-colors" data-decal>Hazard</button>
                            <button onclick="setDecal('barcode')" class="px-4 py-2 border border-white/10 text-xs hover:bg-white/5 rounded transition-colors" data-decal>Data</button>
                        </div>
                    </div>

                    <!-- Size Slider -->
                    <div>
                        <div class="flex justify-between mb-2">
                            <label class="text-xs uppercase tracking-widest text-neutral-500">Fit Scale</label>
                            <span id="size-label" class="text-xs text-white">100%</span>
                        </div>
                        <input type="range" min="80" max="120" value="100" class="w-full" oninput="updateSize(this.value)">
                    </div>

                    <!-- Lighting Control -->
                    <div>
                        <div class="flex justify-between mb-2">
                            <label class="text-xs uppercase tracking-widest text-neutral-500">Light Intensity</label>
                            <span id="light-label" class="text-xs text-white">100%</span>
                        </div>
                        <input type="range" min="0" max="200" value="100" class="w-full" oninput="updateLighting(this.value)">
                    </div>

                    <!-- Animation Controls -->
                    <div class="flex gap-2">
                        <button onclick="toggleRotation()" class="flex-1 px-4 py-2 border border-white/10 text-xs hover:bg-white/5 rounded transition-colors">
                            <span class="iconify mr-1" data-icon="lucide:rotate-cw" data-width="14"></span>
                            Auto-Rotate
                        </button>
                        <button onclick="resetCamera()" class="flex-1 px-4 py-2 border border-white/10 text-xs hover:bg-white/5 rounded transition-colors">
                            <span class="iconify mr-1" data-icon="lucide:refresh-cw" data-width="14"></span>
                            Reset View
                        </button>
                    </div>

                    <!-- Wireframe Toggle -->
                    <button onclick="toggleWireframe()" class="w-full px-4 py-2 border border-white/10 text-xs hover:bg-white/5 rounded transition-colors">
                        <span class="iconify mr-1" data-icon="lucide:hexagon" data-width="14"></span>
                        Wireframe Mode
                    </button>

                    <!-- Screenshot -->
                    <button onclick="takeScreenshot()" class="w-full px-4 py-2 bg-neutral-800 text-white text-xs hover:bg-neutral-700 rounded transition-colors">
                        <span class="iconify mr-1" data-icon="lucide:camera" data-width="14"></span>
                        Capture Design
                    </button>

                    <!-- Add to Cart button for custom design -->
                    <button onclick="addCustomToCart()" class="w-full py-4 bg-white text-black font-semibold text-sm uppercase tracking-widest hover:bg-neutral-200 transition-colors mt-4">
                        Add Custom Design to Cart - $150.00
                    </button>
                </div>
            </div>

            <!-- 3D Mockup Area (Right) -->
            <div class="w-full lg:w-2/3 h-[500px] lg:h-[600px] relative">
                <div id="mockup-container" class="w-full h-full bg-black/40 border border-white/5 rounded-2xl overflow-hidden relative">
                    <!-- Three.js canvas injected here -->
                    
                    <!-- Loading Indicator -->
                    <div id="loading" class="absolute inset-0 flex flex-col items-center justify-center bg-black/80 z-10">
                        <div class="spinner mb-4"></div>
                        <p class="text-xs text-neutral-400 uppercase tracking-widest">Initializing 3D Engine...</p>
                    </div>
                    
                    <!-- FPS Counter -->
                    <div class="absolute top-4 left-4 bg-black/60 backdrop-blur px-2 py-1 rounded text-[10px] text-green-400 font-mono z-20">
                        FPS: <span id="fps-counter">60</span>
                    </div>
                    
                    <!-- Control Guide -->
                    <div class="absolute bottom-4 left-4 bg-black/60 backdrop-blur px-3 py-2 rounded text-[10px] text-neutral-400 z-20">
                        <div>LEFT CLICK + DRAG: Rotate</div>
                        <div>SCROLL: Zoom</div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Stats Section -->
    <section class="py-20 border-b border-white/5">
        <div class="max-w-7xl mx-auto px-6 grid grid-cols-2 md:grid-cols-4 gap-8">
            <div class="text-center md:text-left">
                <h4 class="text-3xl md:text-4xl font-light tracking-tighter">14K+</h4>
                <p class="text-xs text-neutral-500 mt-2 uppercase tracking-widest">Units Deployed</p>
            </div>
            <div class="text-center md:text-left">
                <h4 class="text-3xl md:text-4xl font-light tracking-tighter">0.02s</h4>
                <p class="text-xs text-neutral-500 mt-2 uppercase tracking-widest">Render Speed</p>
            </div>
            <div class="text-center md:text-left">
                <h4 class="text-3xl md:text-4xl font-light tracking-tighter">100%</h4>
                <p class="text-xs text-neutral-500 mt-2 uppercase tracking-widest">Carbon Neutral</p>
            </div>
            <div class="text-center md:text-left">
                <h4 class="text-3xl md:text-4xl font-light tracking-tighter">24/7</h4>
                <p class="text-xs text-neutral-500 mt-2 uppercase tracking-widest">System Support</p>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-black py-16 text-center md:text-left">
        <div class="max-w-7xl mx-auto px-6 grid grid-cols-1 md:grid-cols-4 gap-12">
            <div class="col-span-1 md:col-span-2 space-y-4">
                <div class="flex items-center justify-center md:justify-start gap-2">
                    <span class="iconify text-white" data-icon="lucide:box-select" data-width="24"></span>
                    <span class="brand-font text-xl tracking-widest font-medium">AURA</span>
                </div>
                <p class="text-neutral-500 text-sm max-w-sm mx-auto md:mx-0">
                    Redefining urban utility through digital fabrication. All designs are strictly limited and cryptographically verified.
                </p>
            </div>
            
            <div class="space-y-4">
                <h5 class="text-white text-xs font-semibold uppercase tracking-widest">Platform</h5>
                <ul class="space-y-2 text-sm text-neutral-400">
                    <li><a href="#" class="hover:text-white transition-colors">Latest Drops</a></li>
                    <li><a href="#" class="hover:text-white transition-colors">Visualizer</a></li>
                    <li><a href="#" class="hover:text-white transition-colors">Lookbook</a></li>
                </ul>
            </div>

            <div class="space-y-4">
                <h5 class="text-white text-xs font-semibold uppercase tracking-widest">Legal</h5>
                <ul class="space-y-2 text-sm text-neutral-400">
                    <li><a href="#" class="hover:text-white transition-colors">Terms of Service</a></li>
                    <li><a href="#" class="hover:text-white transition-colors">Privacy Policy</a></li>
                    <li><a href="#" class="hover:text-white transition-colors">Return Protocol</a></li>
                </ul>
            </div>
        </div>
        <div class="max-w-7xl mx-auto px-6 mt-16 pt-8 border-t border-white/10 flex flex-col md:flex-row justify-between items-center text-xs text-neutral-600">
            <p>&copy; 2025 AURA ARCHIVE INC. ALL RIGHTS RESERVED.</p>
            <div class="flex gap-4 mt-4 md:mt-0">
                <a href="#" class="hover:text-white"><span class="iconify" data-icon="lucide:instagram"></span></a>
                <a href="#" class="hover:text-white"><span class="iconify" data-icon="lucide:twitter"></span></a>
                <a href="#" class="hover:text-white"><span class="iconify" data-icon="lucide:disc"></span></a>
            </div>
        </div>
    </footer>

    <!-- Admin Panel Modal -->
    <div id="admin-panel" class="modal items-center justify-center">
        <div class="bg-neutral-900 border border-white/10 rounded-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="sticky top-0 bg-neutral-900 border-b border-white/10 p-6 flex justify-between items-center">
                <h2 class="text-2xl tracking-tight">Product Management</h2>
                <button onclick="toggleAdminPanel()" class="p-2 hover:bg-white/10 rounded-full">
                    <span class="iconify" data-icon="lucide:x" data-width="20"></span>
                </button>
            </div>
            
            <div class="p-6 space-y-6">
                <!-- Add New Product Form -->
                <div class="border border-white/5 rounded-xl p-6 space-y-4">
                    <h3 class="text-lg font-medium">Add New Product</h3>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="text-xs text-neutral-400 block mb-2">Product Name</label>
                            <input type="text" id="new-name" class="w-full bg-black/50 border border-white/10 rounded px-3 py-2 text-sm" placeholder="Enter product name">
                        </div>
                        
                        <div>
                            <label class="text-xs text-neutral-400 block mb-2">Price (USD)</label>
                            <input type="number" id="new-price" class="w-full bg-black/50 border border-white/10 rounded px-3 py-2 text-sm" placeholder="0.00">
                        </div>
                        
                        <div>
                            <label class="text-xs text-neutral-400 block mb-2">Description</label>
                            <input type="text" id="new-description" class="w-full bg-black/50 border border-white/10 rounded px-3 py-2 text-sm" placeholder="Enter description">
                        </div>
                        
                        <div>
                            <label class="text-xs text-neutral-400 block mb-2">Stock Status</label>
                            <select id="new-stock" class="w-full bg-black/50 border border-white/10 rounded px-3 py-2 text-sm">
                                <option value="In Stock">In Stock</option>
                                <option value="Low Stock">Low Stock</option>
                                <option value="Sold Out">Sold Out</option>
                            </select>
                        </div>
                        
                        <div class="md:col-span-2">
                            <label class="text-xs text-neutral-400 block mb-2">Image Description (for placeholder)</label>
                            <input type="text" id="new-image" class="w-full bg-black/50 border border-white/10 rounded px-3 py-2 text-sm" placeholder="Describe the product image">
                        </div>
                    </div>
                    
                    <button onclick="addProduct()" class="w-full bg-white text-black py-3 rounded font-semibold text-sm uppercase tracking-widest hover:bg-neutral-200 transition-colors">
                        Add Product
                    </button>
                </div>
                
                <!-- Existing Products List -->
                <div class="border border-white/5 rounded-xl p-6">
                    <h3 class="text-lg font-medium mb-4">Existing Products</h3>
                    <div id="admin-products-list" class="space-y-4">
                        <!-- Products will be injected here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Shopping Cart Modal -->
    <div id="cart-modal" class="modal items-center justify-center">
        <div class="bg-neutral-900 border border-white/10 rounded-2xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="sticky top-0 bg-neutral-900 border-b border-white/10 p-6 flex justify-between items-center">
                <h2 class="text-2xl tracking-tight">Shopping Cart</h2>
                <button onclick="toggleCart()" class="p-2 hover:bg-white/10 rounded-full">
                    <span class="iconify" data-icon="lucide:x" data-width="20"></span>
                </button>
            </div>
            
            <div class="p-6">
                <div id="cart-items" class="space-y-4 mb-6">
                    <!-- Cart items will be injected here -->
                </div>
                
                <div class="border-t border-white/10 pt-4 space-y-2">
                    <div class="flex justify-between text-sm">
                        <span class="text-neutral-400">Subtotal</span>
                        <span id="cart-subtotal">$0.00</span>
                    </div>
                    <div class="flex justify-between text-sm">
                        <span class="text-neutral-400">Shipping</span>
                        <span>Free</span>
                    </div>
                    <div class="flex justify-between text-lg font-semibold border-t border-white/10 pt-2">
                        <span>Total</span>
                        <span id="cart-total">$0.00</span>
                    </div>
                </div>
                
                <button onclick="proceedToCheckout()" class="w-full bg-white text-black py-4 rounded-lg font-semibold text-sm uppercase tracking-widest hover:bg-neutral-200 transition-colors mt-6">
                    Proceed to Checkout
                </button>
            </div>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div id="checkout-modal" class="modal items-center justify-center">
        <div class="bg-neutral-900 border border-white/10 rounded-2xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="sticky top-0 bg-neutral-900 border-b border-white/10 p-6 flex justify-between items-center">
                <h2 class="text-2xl tracking-tight">Checkout</h2>
                <button onclick="closeCheckout()" class="p-2 hover:bg-white/10 rounded-full">
                    <span class="iconify" data-icon="lucide:x" data-width="20"></span>
                </button>
            </div>
            
            <div class="p-6 space-y-6">
                <!-- Customer Info -->
                <div class="space-y-4">
                    <h3 class="text-lg font-medium">Contact Information</h3>
                    <input type="email" id="checkout-email" class="w-full bg-black/50 border border-white/10 rounded px-3 py-2 text-sm" placeholder="Email address">
                </div>
                
                <!-- Shipping Address -->
                <div class="space-y-4">
                    <h3 class="text-lg font-medium">Shipping Address</h3>
                    <div class="grid grid-cols-2 gap-4">
                        <input type="text" id="checkout-firstname" class="bg-black/50 border border-white/10 rounded px-3 py-2 text-sm" placeholder="First name">
                        <input type="text" id="checkout-lastname" class="bg-black/50 border border-white/10 rounded px-3 py-2 text-sm" placeholder="Last name">
                    </div>
                    <input type="text" id="checkout-address" class="w-full bg-black/50 border border-white/10 rounded px-3 py-2 text-sm" placeholder="Address">
                    <div class="grid grid-cols-2 gap-4">
                        <input type="text" id="checkout-city" class="bg-black/50 border border-white/10 rounded px-3 py-2 text-sm" placeholder="City">
                        <input type="text" id="checkout-zip" class="bg-black/50 border border-white/10 rounded px-3 py-2 text-sm" placeholder="ZIP code">
                    </div>
                    <input type="text" id="checkout-country" class="w-full bg-black/50 border border-white/10 rounded px-3 py-2 text-sm" placeholder="Country">
                </div>
                
                <!-- Payment Info (Stripe) -->
                <div class="space-y-4">
                    <h3 class="text-lg font-medium">Payment Information</h3>
                    <div id="card-element" class="bg-black/50 border border-white/10 rounded px-3 py-3"></div>
                    <div id="card-errors" class="text-red-400 text-xs"></div>
                </div>
                
                <!-- Order Summary -->
                <div class="border border-white/5 rounded-xl p-4 space-y-2">
                    <h3 class="text-sm font-medium mb-2">Order Summary</h3>
                    <div class="flex justify-between text-sm">
                        <span class="text-neutral-400">Total Items</span>
                        <span id="checkout-items-count">0</span>
                    </div>
                    <div class="flex justify-between text-lg font-semibold border-t border-white/10 pt-2">
                        <span>Total</span>
                        <span id="checkout-total">$0.00</span>
                    </div>
                </div>
                
                <button onclick="completeOrder()" class="w-full bg-white text-black py-4 rounded-lg font-semibold text-sm uppercase tracking-widest hover:bg-neutral-200 transition-colors">
                    Complete Order
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts for Interaction -->
    <script>
        // ================= DATA MANAGEMENT =================
        
        let products = JSON.parse(localStorage.getItem('aura-products')) || [
            {
                id: 1,
                name: 'Oversized Vector Hoodie',
                price: 120.00,
                description: 'Heavyweight Cotton / 450GSM',
                image: 'Urban+oversized+black+hoodie+with+geometric+vector+graphics+on+chest+modern+streetwear+photoshoot',
                stock: 'Low Stock'
            },
            {
                id: 2,
                name: 'Tech Utility Vest',
                price: 185.00,
                description: 'Nylon Ripstop / Waterproof',
                image: 'Black+tactical+utility+vest+with+multiple+pockets+water+resistant+nylon+outdoor+fashion+editorial',
                stock: 'In Stock'
            },
            {
                id: 3,
                name: 'Cyber Cargo Pant',
                price: 145.00,
                description: 'Adjustable Fit / 8 Pockets',
                image: 'Black+techwear+cargo+pants+with+multiple+straps+and+utility+pockets+cyberpunk+style+urban+fashion',
                stock: 'In Stock'
            }
        ];
        
        let cart = JSON.parse(localStorage.getItem('aura-cart')) || [];
        
        // Save data to localStorage
        function saveData() {
            localStorage.setItem('aura-products', JSON.stringify(products));
            localStorage.setItem('aura-cart', JSON.stringify(cart));
        }
        
        // ================= PRODUCT MANAGEMENT =================
        
        function renderProducts() {
            const grid = document.getElementById('products-grid');
            grid.innerHTML = products.map(product => `
                <div class="group cursor-pointer scene">
                    <div class="relative aspect-[3/4] bg-neutral-900 overflow-hidden mb-4 border border-white/5 preserve-3d group-hover:scale-[1.02] transition-transform duration-500">
                        <img src="https://placehold.co/600x800?text=${product.image}" 
                             alt="${product.name} product image" 
                             class="w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all duration-700">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                        
                        <div class="absolute bottom-4 left-4 translate-y-4 opacity-0 group-hover:translate-y-0 group-hover:opacity-100 transition-all duration-300">
                            <button onclick="addToCart(${product.id})" class="bg-white text-black text-xs font-semibold px-4 py-2 uppercase tracking-wide hover:bg-neutral-200">
                                Quick Add
                            </button>
                        </div>
                        
                        ${product.stock === 'Low Stock' ? `
                            <div class="absolute top-4 right-4 bg-black/60 backdrop-blur border border-white/10 px-2 py-1 rounded text-[10px] text-white/80">
                                STOCK: LOW
                            </div>
                        ` : product.stock === 'Sold Out' ? `
                            <div class="absolute top-4 right-4 bg-red-500/20 backdrop-blur border border-red-500/30 px-2 py-1 rounded text-[10px] text-red-400">
                                SOLD OUT
                            </div>
                        ` : `
                            <div class="absolute top-4 right-4 bg-green-500/20 backdrop-blur border border-green-500/30 px-2 py-1 rounded text-[10px] text-green-400">
                                IN STOCK
                            </div>
                        `}
                    </div>
                    <div class="flex justify-between items-start">
                        <div>
                            <h3 class="text-lg tracking-tight font-medium">${product.name}</h3>
                            <p class="text-xs text-neutral-500 mt-1">${product.description}</p>
                        </div>
                        <span class="text-sm font-medium text-neutral-300">$${product.price.toFixed(2)}</span>
                    </div>
                </div>
            `).join('');
        }
        
        function renderAdminProducts() {
            const list = document.getElementById('admin-products-list');
            list.innerHTML = products.map(product => `
                <div class="bg-black/50 border border-white/10 rounded-lg p-4">
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex-1">
                            <input type="text" value="${product.name}" onchange="updateProduct(${product.id}, 'name', this.value)" 
                                   class="bg-transparent border-none text-lg font-medium w-full mb-1">
                            <input type="text" value="${product.description}" onchange="updateProduct(${product.id}, 'description', this.value)"
                                   class="bg-transparent border-none text-xs text-neutral-400 w-full">
                        </div>
                        <button onclick="deleteProduct(${product.id})" class="p-2 hover:bg-red-500/20 rounded-full text-red-400">
                            <span class="iconify" data-icon="lucide:trash-2" data-width="16"></span>
                        </button>
                    </div>
                    <div class="grid grid-cols-3 gap-2">
                        <div>
                            <label class="text-[10px] text-neutral-500">Price</label>
                            <input type="number" value="${product.price}" onchange="updateProduct(${product.id}, 'price', parseFloat(this.value))"
                                   class="w-full bg-black/50 border border-white/10 rounded px-2 py-1 text-sm">
                        </div>
                        <div class="col-span-2">
                            <label class="text-[10px] text-neutral-500">Stock Status</label>
                            <select onchange="updateProduct(${product.id}, 'stock', this.value)"
                                    class="w-full bg-black/50 border border-white/10 rounded px-2 py-1 text-sm">
                                <option value="In Stock" ${product.stock === 'In Stock' ? 'selected' : ''}>In Stock</option>
                                <option value="Low Stock" ${product.stock === 'Low Stock' ? 'selected' : ''}>Low Stock</option>
                                <option value="Sold Out" ${product.stock === 'Sold Out' ? 'selected' : ''}>Sold Out</option>
                            </select>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        function addProduct() {
            const name = document.getElementById('new-name').value;
            const price = parseFloat(document.getElementById('new-price').value);
            const description = document.getElementById('new-description').value;
            const stock = document.getElementById('new-stock').value;
            const image = document.getElementById('new-image').value;
            
            if (!name || isNaN(price) || !description || !image) {
                alert('Please fill in all fields correctly');
                return;
            }
            
            const newProduct = {
                id: Date.now(),
                name,
                price,
                description,
                image: image.replace(/ /g, '+'),
                stock
            };
            
            products.push(newProduct);
            saveData();
            renderProducts();
            renderAdminProducts();
            
            // Clear form
            document.getElementById('new-name').value = '';
            document.getElementById('new-price').value = '';
            document.getElementById('new-description').value = '';
            document.getElementById('new-image').value = '';
            
            alert('Product added successfully!');
        }
        
        function updateProduct(id, field, value) {
            const product = products.find(p => p.id === id);
            if (product) {
                product[field] = value;
                saveData();
                renderProducts();
            }
        }
        
        function deleteProduct(id) {
            if (confirm('Are you sure you want to delete this product?')) {
                products = products.filter(p => p.id !== id);
                saveData();
                renderProducts();
                renderAdminProducts();
            }
        }
        
        // ================= SHOPPING CART =================
        
        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;
            
            if (product.stock === 'Sold Out') {
                alert('This product is sold out!');
                return;
            }
            
            const existingItem = cart.find(item => item.id === productId);
            if (existingItem) {
                existingItem.quantity++;
            } else {
                cart.push({
                    id: product.id,
                    name: product.name,
                    price: product.price,
                    quantity: 1
                });
            }
            
            saveData();
            updateCartCount();
            showNotification(`${product.name} added to cart!`);
        }
        
        function addCustomToCart() {
            const customProduct = {
                id: 'custom-' + Date.now(),
                name: 'Custom Design Hoodie',
                price: 150.00,
                quantity: 1
            };
            
            cart.push(customProduct);
            saveData();
            updateCartCount();
            showNotification('Custom design added to cart!');
        }
        
        function removeFromCart(id) {
            cart = cart.filter(item => item.id !== id);
            saveData();
            updateCartCount();
            renderCart();
        }
        
        function updateCartCount() {
            const count = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cart-count').textContent = count;
        }
        
        function renderCart() {
            const cartItems = document.getElementById('cart-items');
            
            if (cart.length === 0) {
                cartItems.innerHTML = '<p class="text-neutral-400 text-center py-8">Your cart is empty</p>';
                document.getElementById('cart-subtotal').textContent = '$0.00';
                document.getElementById('cart-total').textContent = '$0.00';
                return;
            }
            
            cartItems.innerHTML = cart.map(item => `
                <div class="flex gap-4 bg-black/50 border border-white/10 rounded-lg p-4">
                    <div class="flex-1">
                        <h3 class="font-medium">${item.name}</h3>
                        <p class="text-sm text-neutral-400">Quantity: ${item.quantity}</p>
                    </div>
                    <div class="flex items-center gap-4">
                        <span class="font-medium">$${(item.price * item.quantity).toFixed(2)}</span>
                        <button onclick="removeFromCart('${item.id}')" class="p-1 hover:bg-red-500/20 rounded text-red-400">
                            <span class="iconify" data-icon="lucide:x" data-width="16"></span>
                        </button>
                    </div>
                </div>
            `).join('');
            
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            document.getElementById('cart-subtotal').textContent = '$' + subtotal.toFixed(2);
            document.getElementById('cart-total').textContent = '$' + subtotal.toFixed(2);
        }
        
        // ================= CHECKOUT =================
        
        // Initialize Stripe (replace with your publishable key)
        const stripe = Stripe('pk_test_TYooMQauvdEDq54NiTphI7jx');
        let cardElement;
        
        function initializeStripe() {
            const elements = stripe.elements();
            cardElement = elements.create('card', {
                style: {
                    base: {
                        color: '#e5e5e5',
                        fontFamily: 'Inter, sans-serif',
                        fontSize: '14px',
                        '::placeholder': {
                            color: '#737373',
                        },
                    },
                },
            });
            cardElement.mount('#card-element');
            
            cardElement.on('change', (event) => {
                const displayError = document.getElementById('card-errors');
                if (event.error) {
                    displayError.textContent = event.error.message;
                } else {
                    displayError.textContent = '';
                }
            });
        }
        
        function proceedToCheckout() {
            if (cart.length === 0) {
                alert('Your cart is empty!');
                return;
            }
            
            toggleCart();
            document.getElementById('checkout-modal').classList.add('active');
            
            // Update checkout summary
            const itemsCount = cart.reduce((sum, item) => sum + item.quantity, 0);
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            document.getElementById('checkout-items-count').textContent = itemsCount;
            document.getElementById('checkout-total').textContent = '$' + total.toFixed(2);
            
            // Initialize Stripe if not already done
            if (!cardElement) {
                initializeStripe();
            }
        }
        
        function closeCheckout() {
            document.getElementById('checkout-modal').classList.remove('active');
        }
        
        async function completeOrder() {
            // Validate form
            const email = document.getElementById('checkout-email').value;
            const firstName = document.getElementById('checkout-firstname').value;
            const lastName = document.getElementById('checkout-lastname').value;
            const address = document.getElementById('checkout-address').value;
            const city = document.getElementById('checkout-city').value;
            const zip = document.getElementById('checkout-zip').value;
            const country = document.getElementById('checkout-country').value;
            
            if (!email || !firstName || !lastName || !address || !city || !zip || !country) {
                alert('Please fill in all shipping information');
                return;
            }
            
            // Process payment with Stripe
            const {token, error} = await stripe.createToken(cardElement);
            
            if (error) {
                document.getElementById('card-errors').textContent = error.message;
                return;
            }
            
            // Simulate order processing
            showNotification('Processing your order...');
            
            setTimeout(() => {
                // Clear cart
                cart = [];
                saveData();
                updateCartCount();
                
                // Close checkout
                closeCheckout();
                
                // Show success message
                alert('Order completed successfully! Order ID: #' + Math.random().toString(36).substr(2, 9).toUpperCase());
                
                // Clear form
                document.getElementById('checkout-email').value = '';
                document.getElementById('checkout-firstname').value = '';
                document.getElementById('checkout-lastname').value = '';
                document.getElementById('checkout-address').value = '';
                document.getElementById('checkout-city').value = '';
                document.getElementById('checkout-zip').value = '';
                document.getElementById('checkout-country').value = '';
            }, 2000);
        }
        
        // ================= UI CONTROLS =================
        
        function toggleAdminPanel() {
            const panel = document.getElementById('admin-panel');
            panel.classList.toggle('active');
            if (panel.classList.contains('active')) {
                renderAdminProducts();
            }
        }
        
        function toggleCart() {
            const modal = document.getElementById('cart-modal');
            modal.classList.toggle('active');
            if (modal.classList.contains('active')) {
                renderCart();
            }
        }
        
        function showNotification(message) {
            // Simple notification
            const notification = document.createElement('div');
            notification.className = 'fixed bottom-4 right-4 bg-white text-black px-6 py-3 rounded-lg shadow-lg z-50 text-sm font-medium';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
        
        // ================= 3D ENGINE =================
        
        let scene, camera, renderer, hoodie, controls;
        let isRotating = false;
        let currentColor = '#111827';
        let currentMaterial = 'standard';
        let currentDecal = 'none';
        let wireframeMode = false;
        
        // FPS counter
        let lastTime = performance.now();
        let frames = 0;
        
        function init3D() {
            const container = document.getElementById('mockup-container');
            
            // Scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x050505);
            scene.fog = new THREE.Fog(0x050505, 10, 50);
            
            // Camera
            camera = new THREE.PerspectiveCamera(
                35,
                container.clientWidth / container.clientHeight,
                0.1,
                100
            );
            camera.position.set(0, 1.3, 4);
            
            // Renderer
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            renderer.toneMapping = THREE.ACESFilmicToneMapping;
            renderer.toneMappingExposure = 1;
            container.appendChild(renderer.domElement);
            
            // Lights
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambientLight);
            
            const keyLight = new THREE.DirectionalLight(0xffffff, 1.4);
            keyLight.position.set(5, 10, 7);
            keyLight.castShadow = true;
            keyLight.shadow.mapSize.width = 2048;
            keyLight.shadow.mapSize.height = 2048;
            scene.add(keyLight);
            
            const rimLight = new THREE.DirectionalLight(0x4488ff, 0.5);
            rimLight.position.set(-5, 3, -5);
            scene.add(rimLight);
            
            const fillLight = new THREE.DirectionalLight(0xffffff, 0.3);
            fillLight.position.set(-5, 0, 5);
            scene.add(fillLight);
            
            // Controls
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableZoom = true;
            controls.enablePan = false;
            controls.enableDamping = true;
            controls.dampingFactor = 0.08;
            controls.minDistance = 2;
            controls.maxDistance = 8;
            controls.maxPolarAngle = Math.PI / 1.5;
            
            // Grid Floor
            const gridHelper = new THREE.GridHelper(10, 10, 0x333333, 0x222222);
            gridHelper.position.y = -2;
            scene.add(gridHelper);
            
            // Create Hoodie
            createHoodie();
            
            // Hide loading
            document.getElementById('loading').style.display = 'none';
            
            // Animate
            animate();
        }
        
        function createHoodie() {
            hoodie = new THREE.Group();
            
            const material = new THREE.MeshStandardMaterial({
                color: currentColor,
                roughness: 0.7,
                metalness: 0.1
            });
            
            // Body
            const bodyGeom = new THREE.BoxGeometry(1.6, 2, 0.8);
            const body = new THREE.Mesh(bodyGeom, material);
            body.castShadow = true;
            body.receiveShadow = true;
            hoodie.add(body);
            
            // Hood
            const hoodGeom = new THREE.SphereGeometry(0.5, 32, 32, 0, Math.PI * 2, 0, Math.PI / 2);
            const hood = new THREE.Mesh(hoodGeom, material);
            hood.position.set(0, 1.2, 0.2);
            hood.castShadow = true;
            hood.receiveShadow = true;
            hoodie.add(hood);
            
            // Left Sleeve
            const sleeveGeom = new THREE.CylinderGeometry(0.25, 0.2, 1.5, 16);
            const leftSleeve = new THREE.Mesh(sleeveGeom, material);
            leftSleeve.position.set(-1, 0, 0);
            leftSleeve.rotation.z = Math.PI / 8;
            leftSleeve.castShadow = true;
            leftSleeve.receiveShadow = true;
            hoodie.add(leftSleeve);
            
            // Right Sleeve
            const rightSleeve = new THREE.Mesh(sleeveGeom, material);
            rightSleeve.position.set(1, 0, 0);
            rightSleeve.rotation.z = -Math.PI / 8;
            rightSleeve.castShadow = true;
            rightSleeve.receiveShadow = true;
            hoodie.add(rightSleeve);
            
            // Pocket
            const pocketGeom = new THREE.BoxGeometry(0.8, 0.4, 0.15);
            const pocket = new THREE.Mesh(pocketGeom, material);
            pocket.position.set(0, -0.3, 0.45);
            pocket.castShadow = true;
            pocket.receiveShadow = true;
            hoodie.add(pocket);
            
            // Drawstrings
            const stringGeom = new THREE.CylinderGeometry(0.02, 0.02, 0.6, 8);
            const stringMat = new THREE.MeshStandardMaterial({ color: 0xcccccc });
            
            const leftString = new THREE.Mesh(stringGeom, stringMat);
            leftString.position.set(-0.15, 0.9, 0.4);
            leftString.rotation.x = Math.PI / 2;
            hoodie.add(leftString);
            
            const rightString = new THREE.Mesh(stringGeom, stringMat);
            rightString.position.set(0.15, 0.9, 0.4);
            rightString.rotation.x = Math.PI / 2;
            hoodie.add(rightString);
            
            hoodie.scale.set(1, 1, 1);
            hoodie.position.y = -0.5;
            scene.add(hoodie);
            
            // Apply initial decal
            applyDecal();
        }
        
        function animate() {
            requestAnimationFrame(animate);
            
            if (isRotating && hoodie) {
                hoodie.rotation.y += 0.005;
            }
            
            controls.update();
            renderer.render(scene, camera);
            
            // Update FPS
            frames++;
            const time = performance.now();
            if (time >= lastTime + 1000) {
                document.getElementById('fps-counter').textContent = frames;
                frames = 0;
                lastTime = time;
            }
        }
        
        // ================= 3D CUSTOMIZATION FUNCTIONS =================
        
        function changeColor(hex) {
            currentColor = hex;
            if (!hoodie) return;
            
            hoodie.traverse((child) => {
                if (child.isMesh && child.material.color) {
                    child.material.color.set(hex);
                }
            });
            
            // Update button states
            document.querySelectorAll('[data-color]').forEach(btn => {
                btn.classList.remove('ring-2', 'ring-white');
            });
            event.target.classList.add('ring-2', 'ring-white');
        }
        
        function setMaterial(type) {
            currentMaterial = type;
            if (!hoodie) return;
            
            let roughness = 0.7;
            let metalness = 0.1;
            
            switch(type) {
                case 'glossy':
                    roughness = 0.2;
                    metalness = 0.3;
                    break;
                case 'matte':
                    roughness = 1.0;
                    metalness = 0;
                    break;
                case 'metallic':
                    roughness = 0.3;
                    metalness = 0.9;
                    break;
            }
            
            hoodie.traverse((child) => {
                if (child.isMesh && child.material.roughness !== undefined) {
                    child.material.roughness = roughness;
                    child.material.metalness = metalness;
                    child.material.needsUpdate = true;
                }
            });
            
            // Update button states
            document.querySelectorAll('[data-material]').forEach(btn => {
                btn.classList.remove('bg-white/10', 'border-white');
            });
            event.target.classList.add('bg-white/10', 'border-white');
        }
        
        function setDecal(type) {
            currentDecal = type;
            applyDecal();
            
            // Update button states
            document.querySelectorAll('[data-decal]').forEach(btn => {
                btn.classList.remove('bg-white/10', 'border-white');
            });
            event.target.classList.add('bg-white/10', 'border-white');
        }
        
        function applyDecal() {
            if (!hoodie) return;
            
            // Remove existing decal
            const existingDecal = hoodie.children.find(child => child.name === 'decal');
            if (existingDecal) {
                hoodie.remove(existingDecal);
            }
            
            if (currentDecal === 'none') return;
            
            // Create canvas for decal
            const canvas = document.createElement('canvas');
            canvas.width = 512;
            canvas.height = 512;
            const ctx = canvas.getContext('2d');
            
            ctx.fillStyle = '#ffffff';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            
            switch(currentDecal) {
                case 'logo':
                    ctx.font = 'bold 80px Arial';
                    ctx.fillText('AURA', 256, 200);
                    ctx.font = '40px Arial';
                    ctx.fillText('ARCHIVE', 256, 280);
                    break;
                case 'warning':
                    ctx.strokeStyle = '#ffff00';
                    ctx.lineWidth = 20;
                    ctx.beginPath();
                    ctx.moveTo(256, 100);
                    ctx.lineTo(400, 400);
                    ctx.lineTo(112, 400);
                    ctx.closePath();
                    ctx.stroke();
                    ctx.font = 'bold 120px Arial';
                    ctx.fillStyle = '#ffff00';
                    ctx.fillText('!', 256, 280);
                    break;
                case 'barcode':
                    ctx.fillStyle = '#000000';
                    for (let i = 0; i < 30; i++) {
                        const x = 100 + i * 10;
                        const height = Math.random() * 200 + 100;
                        ctx.fillRect(x, 200, Math.random() > 0.5 ? 8 : 4, height);
                    }
                    ctx.fillStyle = '#ffffff';
                    ctx.font = '24px monospace';
                    ctx.fillText('9876543210987', 256, 420);
                    break;
            }
            
            // Create texture from canvas
            const texture = new THREE.CanvasTexture(canvas);
            const decalMaterial = new THREE.MeshBasicMaterial({
                map: texture,
                transparent: true,
                opacity: 0.9
            });
            
            const decalGeom = new THREE.PlaneGeometry(0.6, 0.6);
            const decalMesh = new THREE.Mesh(decalGeom, decalMaterial);
            decalMesh.position.set(0, 0.3, 0.42);
            decalMesh.name = 'decal';
            hoodie.add(decalMesh);
        }
        
        function updateSize(value) {
            document.getElementById('size-label').textContent = value + '%';
            if (!hoodie) return;
            
            const scale = value / 100;
            hoodie.scale.set(scale, scale, scale);
        }
        
        function updateLighting(value) {
            document.getElementById('light-label').textContent = value + '%';
            
            const intensity = value / 100;
            scene.traverse(child => {
                if (child.isLight) {
                    child.intensity = child.intensity * intensity;
                }
            });
        }
        
        function toggleRotation() {
            isRotating = !isRotating;
        }
        
        function resetCamera() {
            camera.position.set(0, 1.3, 4);
            controls.target.set(0, 0, 0);
            controls.update();
        }
        
        function toggleWireframe() {
            wireframeMode = !wireframeMode;
            if (!hoodie) return;
            
            hoodie.traverse((child) => {
                if (child.isMesh) {
                    child.material.wireframe = wireframeMode;
                    child.material.needsUpdate = true;
                }
            });
        }
        
        function takeScreenshot() {
            renderer.render(scene, camera);
            const dataURL = renderer.domElement.toDataURL('image/png');
            
            const link = document.createElement('a');
            link.download = 'aura-design-' + Date.now() + '.png';
            link.href = dataURL;
            link.click();
            
            showNotification('Screenshot saved!');
        }
        
        // Handle window resize
        window.addEventListener('resize', () => {
            const container = document.getElementById('mockup-container');
            if (!container) return;
            camera.aspect = container.clientWidth / container.clientHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(container.clientWidth, container.clientHeight);
        });
        
        // ================= INITIALIZATION =================
        
        window.addEventListener('DOMContentLoaded', () => {
            renderProducts();
            updateCartCount();
            init3D();
        });
    </script>

</body>
</html>
